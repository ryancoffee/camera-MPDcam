<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Single Photon Counting Camera SDK: SDK_Example.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="MPD+SPC3_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Single Photon Counting Camera SDK
   &#160;<span id="projectnumber">2.2.0B</span>
   </div>
   <div id="projectbrief">SPC3-SDK</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_s_d_k__example_8c-example.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">SDK_Example.c</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment">#######################################</span></div><div class="line"><span class="comment">                                                 </span></div><div class="line"><span class="comment">Copyright 2015-2017 Micro-Photon-Devices s.r.l.                                 </span></div><div class="line"><span class="comment">                                                 </span></div><div class="line"><span class="comment">SOFTWARE PRODUCT: SPC3_SDK                                     </span></div><div class="line"><span class="comment">                                                 </span></div><div class="line"><span class="comment">Micro-Photon-Devices (MPD) expressly disclaims any warranty for the SOFTWARE PRODUCT.          </span></div><div class="line"><span class="comment">The SOFTWARE PRODUCT is provided &#39;As Is&#39; without any express or implied warranty of any kind,      </span></div><div class="line"><span class="comment">including but not limited to any warranties of merchantability, noninfringement, or          </span></div><div class="line"><span class="comment">fitness of a particular purpose. MPD does not warrant or assume responsibility for the          </span></div><div class="line"><span class="comment">accuracy or completeness of any information, text, graphics, links or other items contained      </span></div><div class="line"><span class="comment">within the SOFTWARE PRODUCT. MPD further expressly disclaims any warranty or representation      </span></div><div class="line"><span class="comment">to Authorized Users or to any third party.                             </span></div><div class="line"><span class="comment">In no event shall MPD be liable for any damages (including, without limitation, lost profits,    </span></div><div class="line"><span class="comment">business interruption, or lost information) rising out of &#39;Authorized Users&#39; use of or inability </span></div><div class="line"><span class="comment">to use the SOFTWARE PRODUCT, even if MPD has been advised of the possibility of such damages.    </span></div><div class="line"><span class="comment">In no event will MPD be liable for loss of data or for indirect, special, incidental,          </span></div><div class="line"><span class="comment">consequential (including lost profit), or other damages based in contract, tort          </span></div><div class="line"><span class="comment">or otherwise. MPD shall have no liability with respect to the content of the              </span></div><div class="line"><span class="comment">SOFTWARE PRODUCT or any part thereof, including but not limited to errors or omissions contained </span></div><div class="line"><span class="comment">therein, libel, infringements of rights of publicity, privacy, trademark rights, business      </span></div><div class="line"><span class="comment">interruption, personal injury, loss of privacy, moral rights or the disclosure of confidential      </span></div><div class="line"><span class="comment">information.                                             </span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">#######################################</span></div><div class="line"><span class="comment">*/</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="_s_p_c3___s_d_k_8h.html">SPC3_SDK.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;math.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;time.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#if defined(__linux__)</span></div><div class="line"><span class="preprocessor">    #define SLEEP usleep</span></div><div class="line"><span class="preprocessor">    #define MILLIS 1000</span></div><div class="line"><span class="preprocessor">#elif defined(__APPLE__)</span></div><div class="line"><span class="preprocessor">    #define SLEEP usleep</span></div><div class="line"><span class="preprocessor">    #define MILLIS 1000</span></div><div class="line"><span class="preprocessor">    #include &lt;unistd.h&gt;</span></div><div class="line"><span class="preprocessor">#elif defined(_WIN32)</span></div><div class="line"><span class="preprocessor">    #include &lt;Windows.h&gt;</span></div><div class="line"><span class="preprocessor">    #define SLEEP Sleep</span></div><div class="line"><span class="preprocessor">    #define MILLIS 1</span></div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line"><span class="comment">//*************************************//</span></div><div class="line"><span class="comment">//                                                                         //   </span></div><div class="line"><span class="comment">//              Support functions                          //</span></div><div class="line"><span class="comment">//                                                                         //</span></div><div class="line"><span class="comment">//*************************************//</span></div><div class="line"></div><div class="line"><span class="comment">// Calculate the mean value of a UInt16 image</span></div><div class="line"><span class="keywordtype">double</span> mean(<a class="code" href="_s_p_c3___s_d_k_8h.html#accc14a7c843716dfed734f3a03e8d2b6">UInt16</a> * Img, <a class="code" href="_s_p_c3___s_d_k_8h.html#accc14a7c843716dfed734f3a03e8d2b6">UInt16</a> NPixel)</div><div class="line">{</div><div class="line">        <span class="keywordtype">int</span> i=0;</div><div class="line">        <span class="keywordtype">double</span> res =0.0;</div><div class="line">        <span class="keywordflow">for</span>(i=0;i&lt;NPixel;i++)   </div><div class="line">                res+= (<span class="keywordtype">double</span>)Img[i];</div><div class="line">        <span class="keywordflow">return</span> res/(double)NPixel;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// Calculate the mean value of a double image </span></div><div class="line"><span class="keywordtype">double</span> mean_double(<span class="keywordtype">double</span> * Img, <a class="code" href="_s_p_c3___s_d_k_8h.html#accc14a7c843716dfed734f3a03e8d2b6">UInt16</a> NPixel)</div><div class="line">{</div><div class="line">        <span class="keywordtype">int</span> i=0;</div><div class="line">        <span class="keywordtype">double</span> res =0.0;</div><div class="line">        <span class="keywordflow">for</span>(i=0;i&lt;NPixel;i++)   </div><div class="line">                res+= Img[i];</div><div class="line">        <span class="keywordflow">return</span> res/(double)NPixel;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// Create an histogram of the distribution of photon counts over the imager</span></div><div class="line"><span class="keywordtype">void</span> Hist(<a class="code" href="_s_p_c3___s_d_k_8h.html#accc14a7c843716dfed734f3a03e8d2b6">UInt16</a>* Img, <a class="code" href="_s_p_c3___s_d_k_8h.html#accc14a7c843716dfed734f3a03e8d2b6">UInt16</a>* hist)</div><div class="line">{</div><div class="line">        <span class="keywordtype">int</span> i=0;</div><div class="line">        memset(hist,<span class="charliteral">&#39;\0&#39;</span>,65535*<span class="keyword">sizeof</span>(<a class="code" href="_s_p_c3___s_d_k_8h.html#accc14a7c843716dfed734f3a03e8d2b6">UInt16</a>));</div><div class="line">        <span class="keywordflow">for</span>(i=0;i&lt;2048;i++)</div><div class="line">                hist[Img[i]]++;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//***********************************//</span></div><div class="line"><span class="comment">//                                                                       //</span></div><div class="line"><span class="comment">//              Main code                                        //</span></div><div class="line"><span class="comment">//                                                                       //</span></div><div class="line"><span class="comment">//***********************************//</span></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line"><span class="comment">// variables definition //</span></div><div class="line"><span class="comment"></span>        <a class="code" href="group___enum.html#gaa61696df8eccf9a32c4769b1037ffc07">SPC3_H</a> spc3= NULL;</div><div class="line">        <a class="code" href="_s_p_c3___s_d_k_8h.html#accc14a7c843716dfed734f3a03e8d2b6">UInt16</a>* Img= NULL,hist[65535],AppliedDT=0;</div><div class="line">        <span class="keywordtype">char</span> header[1024]=<span class="stringliteral">&quot;&quot;</span>;</div><div class="line">        <span class="keywordtype">int</span> integFrames=10;</div><div class="line">        <span class="keywordtype">double</span> read_bytes=0,total_bytes=0;</div><div class="line">        <span class="keywordtype">int</span> i=0,j=0,k=0,out=0;</div><div class="line">        <span class="keywordtype">short</span> trig=0;</div><div class="line">        <span class="keywordtype">double</span> gateoff=0;</div><div class="line">        <span class="keywordtype">double</span> gateoff_array[3] = { 0 };</div><div class="line">        <span class="keywordtype">double</span> counts[3] = {0};</div><div class="line">        <span class="keywordtype">double</span> *x = NULL,*y= NULL, *z = NULL, *Imgd=NULL;</div><div class="line">        <span class="keywordtype">double</span>* data= NULL;</div><div class="line">        <span class="keywordtype">char</span> c=0,*fname=NULL;</div><div class="line">        <a class="code" href="group___enum.html#gac42b8b3d3ae15fd64d442c5d0a4d529d">BUFFER_H</a> buffer = NULL;</div><div class="line">        <span class="keywordtype">int</span> counter = 0, aggressor=0;</div><div class="line">        <a class="code" href="group___enum.html#gafe63699eafdb0b69d032828ea3f157d3">SPC3Return</a> error = <a name="a0"></a><a class="code" href="group___enum.html#ggafe63699eafdb0b69d032828ea3f157d3a2bc49ec37d6a5715dd23e85f1ff5bb59">OK</a>;</div><div class="line">        FILE* f= NULL;</div><div class="line">        time_t start,stop;</div><div class="line">        <span class="keywordtype">char</span> *Test[] = { <span class="stringliteral">&quot;Live mode: write on stdout 10 images&quot;</span>, <span class="comment">//0</span></div><div class="line">                                         <span class="stringliteral">&quot;Holdoff: mean number of photons at different holdoff values&quot;</span>, <span class="comment">//1</span></div><div class="line">                                         <span class="stringliteral">&quot;Dead-time corrector improves the image quality&quot;</span>, <span class="comment">//2</span></div><div class="line">                                         <span class="stringliteral">&quot;Background subtraction: 2 output files, with and without BG&quot;</span>, <span class="comment">//3</span></div><div class="line">                                         <span class="stringliteral">&quot;Gate: 1000 images normal, 1000 images with gate 3 ns shift 5 ns&quot;</span>, <span class="comment">//4</span></div><div class="line">                                         <span class="stringliteral">&quot;Synchronization output&quot;</span>, <span class="comment">//5</span></div><div class="line">                                         <span class="stringliteral">&quot;Background statistics&quot;</span>, <span class="comment">//6</span></div><div class="line">                                         <span class="stringliteral">&quot;Gate: calibrate the length of the gate signal&quot;</span>, <span class="comment">//7</span></div><div class="line">                                         <span class="stringliteral">&quot;Triple gate mode&quot;</span>, <span class="comment">//8</span></div><div class="line">                                         <span class="stringliteral">&quot;Read and write test images&quot;</span>, <span class="comment">//9</span></div><div class="line">                                         <span class="stringliteral">&quot;Calculate the correlation image&quot;</span>, <span class="comment">//a</span></div><div class="line">                                        <span class="stringliteral">&quot;Continuous acquisition on file&quot;</span>, <span class="comment">//b</span></div><div class="line">                                        <span class="stringliteral">&quot;Continuous acquisition in memory&quot;</span> <span class="comment">//c</span></div><div class="line">                                        };</div><div class="line">        Imgd =(<span class="keywordtype">double</span>*) calloc(1, 2048* <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line">        Img =(<a class="code" href="_s_p_c3___s_d_k_8h.html#accc14a7c843716dfed734f3a03e8d2b6">UInt16</a>*) calloc(1, 2048* <span class="keyword">sizeof</span>(<a class="code" href="_s_p_c3___s_d_k_8h.html#accc14a7c843716dfed734f3a03e8d2b6">UInt16</a>));</div><div class="line">        data =(<span class="keywordtype">double</span>*) calloc(1, 2048* <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line">        x =(<span class="keywordtype">double</span>*) calloc(1, 65535* <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line">        y =(<span class="keywordtype">double</span>*) calloc(1, 65535* <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line">        z = (<span class="keywordtype">double</span>*)calloc(1, 65535 * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"></div><div class="line"><span class="comment">// Simple menu for test selection //</span></div><div class="line"><span class="comment"></span></div><div class="line">        printf(<span class="stringliteral">&quot;*******************************************************\n&quot;</span>);</div><div class="line">        printf(<span class="stringliteral">&quot;SPC3 Test program\n&quot;</span>);</div><div class="line">        printf(<span class="stringliteral">&quot;*******************************************************\n\n\n\n&quot;</span>);</div><div class="line">        <span class="keywordflow">for</span> (i = 0; i&lt;13; i++)</div><div class="line">                printf(<span class="stringliteral">&quot;\t%x) %s\n&quot;</span>,i, Test[i]);</div><div class="line">        printf(<span class="stringliteral">&quot;\tq) Quit\n&quot;</span>);</div><div class="line">        <span class="keywordflow">do</span> </div><div class="line">        {</div><div class="line">                c=getchar();</div><div class="line">        } <span class="keywordflow">while</span> ((c&lt;48 || c&gt;58) &amp;&amp; c != <span class="charliteral">&#39;q&#39;</span> &amp;&amp; c != <span class="charliteral">&#39;a&#39;</span> &amp;&amp; c != <span class="charliteral">&#39;b&#39;</span> &amp;&amp; c != <span class="charliteral">&#39;c&#39;</span>);</div><div class="line">        getchar();</div><div class="line">        <span class="keywordflow">if</span>(c&gt;47 &amp;&amp; c&lt;59)</div><div class="line">        {</div><div class="line">                printf(<span class="stringliteral">&quot;*******************************************************\n&quot;</span>);</div><div class="line">                printf(<span class="stringliteral">&quot;%s\n&quot;</span>,Test[c-48]);</div><div class="line">                printf(<span class="stringliteral">&quot;*******************************************************\n\n\n&quot;</span>);</div><div class="line">        }</div><div class="line">        <span class="keywordflow">if</span>(c==<span class="charliteral">&#39;a&#39;</span>)</div><div class="line">        {</div><div class="line">                printf(<span class="stringliteral">&quot;*******************************************************\n&quot;</span>);</div><div class="line">                printf(<span class="stringliteral">&quot;%s\n&quot;</span>,Test[10]);</div><div class="line">                printf(<span class="stringliteral">&quot;*******************************************************\n\n\n&quot;</span>);</div><div class="line">        }</div><div class="line">        <span class="keywordflow">if</span>(c==<span class="charliteral">&#39;b&#39;</span>)</div><div class="line">        {</div><div class="line">                printf(<span class="stringliteral">&quot;*******************************************************\n&quot;</span>);</div><div class="line">                printf(<span class="stringliteral">&quot;%s\n&quot;</span>,Test[11]);</div><div class="line">                printf(<span class="stringliteral">&quot;*******************************************************\n\n\n&quot;</span>);</div><div class="line">        }</div><div class="line">        <span class="keywordflow">if</span> (c == <span class="charliteral">&#39;c&#39;</span>)</div><div class="line">        {</div><div class="line">                printf(<span class="stringliteral">&quot;*******************************************************\n&quot;</span>);</div><div class="line">                printf(<span class="stringliteral">&quot;%s\n&quot;</span>, Test[12]);</div><div class="line">                printf(<span class="stringliteral">&quot;*******************************************************\n\n\n&quot;</span>);</div><div class="line">        }</div><div class="line">        <span class="keywordflow">switch</span>(c)</div><div class="line">        {</div><div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;0&#39;</span>:<span class="comment">//Test live mode</span></div><div class="line">                <span class="comment">//SPC3 constructor and parameter setting</span></div><div class="line">                <a name="a1"></a><a class="code" href="group___con_des.html#gaabc8772c1952c0b526959a665bee7016">SPC3_Constr</a>(&amp;spc3, <a name="a2"></a><a class="code" href="group___enum.html#ggac6e73fe6ce68e10b0acd6d2312bdbb35a5ecbcf0afce98b042f35ec71ba03fa4b">Normal</a>,<span class="stringliteral">&quot;&quot;</span>);</div><div class="line">                <a name="a3"></a><a class="code" href="group___set.html#ga8623c09e223ea3246ab50618e59ea208">SPC3_Set_Camera_Par</a>(spc3, 100, 30000,300,1,Disabled,Disabled,Disabled);         </div><div class="line">                <a name="a4"></a><a class="code" href="group___set.html#ga95cd1cca080ad3e9f2e227566c12b9ee">SPC3_Set_Trigger_Out_State</a>(spc3,<a name="a5"></a><a class="code" href="group___enum.html#ggaa534ed76b07c3983382a53e00e53e94aa20e5ef7f93ae45b4c343ef8805f9d558">Frame</a>);</div><div class="line">                <a name="a6"></a><a class="code" href="group___set.html#ga8d9d19541dea48c14122e67ebbccdbcc">SPC3_Apply_settings</a>(spc3); </div><div class="line">                <a name="a7"></a><a class="code" href="group___set.html#ga506b0720df7701ce7eb9241c0db8d760">SPC3_Set_Live_Mode_ON</a>(spc3);</div><div class="line">                <span class="comment">//Acquistion of 10 live images</span></div><div class="line">                <span class="keywordflow">for</span>(i=0;i&lt;10;i++)</div><div class="line">                {</div><div class="line">                        printf(<span class="stringliteral">&quot;Image %d:\n&quot;</span>,i);</div><div class="line">                        <a name="a8"></a><a class="code" href="group___get.html#gaf52ed766397fc87aa8990cce79b6aa39">SPC3_Get_Live_Img</a>(spc3, Img);</div><div class="line">                        <span class="keywordflow">for</span>(j=0;j&lt;32;j++)</div><div class="line">                        {</div><div class="line">                                <span class="keywordflow">for</span>(k=0;k&lt;32;k++)</div><div class="line">                                        printf(<span class="stringliteral">&quot;%d &quot;</span>,Img[32*j+k]);</div><div class="line">                                printf(<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line">                        }               </div><div class="line">                }</div><div class="line">                <span class="comment">//Live mode off</span></div><div class="line">                <a name="a9"></a><a class="code" href="group___set.html#ga199cf23a5624b22baa7ba194ff57c560">SPC3_Set_Live_Mode_OFF</a>(spc3);                                           </div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;1&#39;</span>:<span class="comment">//Test dead-time</span></div><div class="line">                <span class="comment">//SPC3 constructor and parameter setting</span></div><div class="line">                out=(int)<a class="code" href="group___con_des.html#gaabc8772c1952c0b526959a665bee7016">SPC3_Constr</a>(&amp;spc3, <a name="a10"></a><a class="code" href="group___enum.html#ggac6e73fe6ce68e10b0acd6d2312bdbb35a5a6d9ac0f3d8ebfb251b014eb0cd7bec">Advanced</a>,<span class="stringliteral">&quot;&quot;</span>);</div><div class="line">                <a class="code" href="group___set.html#ga8623c09e223ea3246ab50618e59ea208">SPC3_Set_Camera_Par</a>(spc3, 1040, 10,1,1,Disabled,Disabled,Disabled);</div><div class="line">                <a class="code" href="group___set.html#ga8d9d19541dea48c14122e67ebbccdbcc">SPC3_Apply_settings</a>(spc3);</div><div class="line">                k=0;                    </div><div class="line">                printf(<span class="stringliteral">&quot;Acquiring:\n&quot;</span>);</div><div class="line">                <span class="comment">//Open file</span></div><div class="line">                <span class="keywordflow">if</span>((f = fopen(<span class="stringliteral">&quot;DTValues.txt&quot;</span>,<span class="stringliteral">&quot;w&quot;</span>)) == NULL)</div><div class="line">                {</div><div class="line">                        printf(<span class="stringliteral">&quot;Unable to open the output file.\n&quot;</span>);</div><div class="line">                        <span class="keywordflow">break</span>;</div><div class="line">                }</div><div class="line">                <span class="comment">//set deadtime, acquire snap, calculate mean photon count value and save results</span></div><div class="line">                <span class="keywordflow">for</span>(i=<a name="a11"></a><a class="code" href="_s_p_c3___s_d_k_8h.html#a38c2134b201fada115ed6c367801bcf0">MAX_DEAD_TIME</a>;i&gt;=<a name="a12"></a><a class="code" href="_s_p_c3___s_d_k_8h.html#ace33148a67cf63b3aa7b83ebfcabfe63">MIN_DEAD_TIME</a>;i-=30)</div><div class="line">                {                       </div><div class="line">                        data[k]=0.0;</div><div class="line">                        <a name="a13"></a><a class="code" href="group___set.html#ga51a1131fcdd790b3d1ed4a5cd253c21c">SPC3_Set_DeadTime</a>(spc3, i);</div><div class="line">                        <a class="code" href="group___set.html#ga8d9d19541dea48c14122e67ebbccdbcc">SPC3_Apply_settings</a>(spc3);</div><div class="line">                        <a name="a14"></a><a class="code" href="group___get.html#ga29f4aa5c7e15724b7fc2d2d2808f51b6">SPC3_Get_DeadTime</a>(spc3, i, &amp;AppliedDT);</div><div class="line">                        x[k]=(double)AppliedDT;</div><div class="line">                        <a name="a15"></a><a class="code" href="group___get.html#ga451637b30c4cf1e118f8f2f5e2917829">SPC3_Prepare_Snap</a>(spc3);</div><div class="line">                        <a name="a16"></a><a class="code" href="group___get.html#gafd925e789cb0d273548778e848699e69">SPC3_Get_Snap</a>(spc3);</div><div class="line">                        <a name="a17"></a><a class="code" href="group___add_m.html#ga2f8901c7892f12dd497a45b62f4e642f">SPC3_Average_Img</a>(spc3,Imgd,1);</div><div class="line">                        data[k]=mean_double(Imgd,2048);                 </div><div class="line">                        printf(<span class="stringliteral">&quot;%d ns, Applied %d ns, %f\n&quot;</span>, i, AppliedDT, data[k]);</div><div class="line">                        fprintf(f,<span class="stringliteral">&quot;%d %f\n&quot;</span>,i,data[k]);</div><div class="line">                        k++;</div><div class="line">                }</div><div class="line">                <span class="comment">//print summary</span></div><div class="line">                printf(<span class="stringliteral">&quot;\nDead-time calibration\n&quot;</span>);</div><div class="line">                <span class="keywordflow">for</span>(i=0;i&lt;k;i++)</div><div class="line">                {</div><div class="line">                        printf(<span class="stringliteral">&quot;%f %f\n&quot;</span>,x[i],data[i]);</div><div class="line">                }</div><div class="line">                fclose(f);                              </div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;2&#39;</span>: <span class="comment">//Dead-time corrector effect</span></div><div class="line">                <span class="comment">//SPC3 constructor and parameter setting</span></div><div class="line">                out=(int)<a class="code" href="group___con_des.html#gaabc8772c1952c0b526959a665bee7016">SPC3_Constr</a>(&amp;spc3, <a class="code" href="group___enum.html#ggac6e73fe6ce68e10b0acd6d2312bdbb35a5ecbcf0afce98b042f35ec71ba03fa4b">Normal</a>,<span class="stringliteral">&quot;&quot;</span>);</div><div class="line">                <a class="code" href="group___set.html#ga8623c09e223ea3246ab50618e59ea208">SPC3_Set_Camera_Par</a>(spc3, 4096, 1000,100,1,Disabled,Disabled,Disabled);</div><div class="line">                <a class="code" href="group___set.html#ga51a1131fcdd790b3d1ed4a5cd253c21c">SPC3_Set_DeadTime</a>(spc3, 100);</div><div class="line">                <span class="comment">//acquisition with DTC on</span></div><div class="line">                printf(<span class="stringliteral">&quot;Acquire the image using the dead-time correction\n&quot;</span>);</div><div class="line">                <a name="a18"></a><a class="code" href="group___set.html#ga4a4196d57dabe0abfbea427e80ce8f03">SPC3_Set_DeadTime_Correction</a>(spc3, Enabled);</div><div class="line">                <a class="code" href="group___set.html#ga8d9d19541dea48c14122e67ebbccdbcc">SPC3_Apply_settings</a>(spc3);</div><div class="line">                <span class="comment">//Acquire the BG image first</span></div><div class="line">                printf(<span class="stringliteral">&quot;\n\n\nClose the camera shutter and press ENTER...\n&quot;</span>);          </div><div class="line">                getchar();</div><div class="line">                <a class="code" href="group___get.html#ga451637b30c4cf1e118f8f2f5e2917829">SPC3_Prepare_Snap</a>(spc3);</div><div class="line">                <a class="code" href="group___get.html#gafd925e789cb0d273548778e848699e69">SPC3_Get_Snap</a>(spc3);</div><div class="line">                <span class="comment">//Calculate the average image</span></div><div class="line">                <a class="code" href="group___add_m.html#ga2f8901c7892f12dd497a45b62f4e642f">SPC3_Average_Img</a>(spc3, data,1);</div><div class="line">                <span class="keywordflow">for</span>(i=0;i&lt;2048;i++)</div><div class="line">                        <span class="keywordflow">if</span>(data[i]&lt;= 65535)</div><div class="line">                                Img[i] = (<a name="a19"></a><a class="code" href="_s_p_c3___s_d_k_8h.html#accc14a7c843716dfed734f3a03e8d2b6">UInt16</a>) floor(data[i]+0.5);</div><div class="line">                        <span class="keywordflow">else</span></div><div class="line">                                Img[i] = 65535; <span class="comment">// Avoid overflow</span></div><div class="line">                <a name="a20"></a><a class="code" href="group___set.html#ga0b457a043f8243a81edf50c4e0f0369c">SPC3_Set_Background_Img</a>(spc3, Img);</div><div class="line">                <a name="a21"></a><a class="code" href="group___set.html#gae26acc230984264c39e5bb65c8054288">SPC3_Set_Background_Subtraction</a>(spc3, Enabled);</div><div class="line">                <a class="code" href="group___set.html#ga8d9d19541dea48c14122e67ebbccdbcc">SPC3_Apply_settings</a>(spc3);</div><div class="line">                <span class="comment">//now acquire the image with shutter open</span></div><div class="line">                printf(<span class="stringliteral">&quot;\n\n\nOpen the camera shutter and press ENTER...\n&quot;</span>);           </div><div class="line">                getchar();</div><div class="line">                <a class="code" href="group___get.html#ga451637b30c4cf1e118f8f2f5e2917829">SPC3_Prepare_Snap</a>(spc3);</div><div class="line">                <a class="code" href="group___get.html#gafd925e789cb0d273548778e848699e69">SPC3_Get_Snap</a>(spc3);</div><div class="line">        <a name="a22"></a><a class="code" href="group___add_m.html#ga5dde5f5c97f5d3bcf04b95575fe66d1f">SPC3_Save_Img_Disk</a>(spc3, 1, 100, <span class="stringliteral">&quot;Im_DeadTimeCorrected&quot;</span>, <a name="a23"></a><a class="code" href="group___enum.html#gga668f80b66f368a1f46233e43ab78e124ace8fa6e3d592c00db516c31f16a7b821">TIFF_NO_COMPRESSION</a>);</div><div class="line">                printf(<span class="stringliteral">&quot;The the dead-time corrected image was acquired and stored on the hard disk succesfully!\n&quot;</span>);</div><div class="line">                <span class="comment">//acquisition with DTC off</span></div><div class="line">                printf(<span class="stringliteral">&quot;\n\nAcquire the reference image without the dead-time correction\n&quot;</span>);</div><div class="line">                <a class="code" href="group___set.html#gae26acc230984264c39e5bb65c8054288">SPC3_Set_Background_Subtraction</a>(spc3, Disabled);</div><div class="line">                <a class="code" href="group___set.html#ga4a4196d57dabe0abfbea427e80ce8f03">SPC3_Set_DeadTime_Correction</a>(spc3, Disabled);</div><div class="line">                <a class="code" href="group___set.html#ga8d9d19541dea48c14122e67ebbccdbcc">SPC3_Apply_settings</a>(spc3);</div><div class="line">                <span class="comment">//Acquire the BG image first</span></div><div class="line">                printf(<span class="stringliteral">&quot;\n\n\nClose the camera shutter and press ENTER...\n&quot;</span>);          </div><div class="line">                getchar();</div><div class="line">                <a class="code" href="group___get.html#ga451637b30c4cf1e118f8f2f5e2917829">SPC3_Prepare_Snap</a>(spc3);</div><div class="line">                <a class="code" href="group___get.html#gafd925e789cb0d273548778e848699e69">SPC3_Get_Snap</a>(spc3);</div><div class="line">                <span class="comment">//Calculate the average image</span></div><div class="line">                <a class="code" href="group___add_m.html#ga2f8901c7892f12dd497a45b62f4e642f">SPC3_Average_Img</a>(spc3, data,1);</div><div class="line">                <span class="keywordflow">for</span>(i=0;i&lt;2048;i++)</div><div class="line">                        <span class="keywordflow">if</span>(data[i]&lt;= 65535)</div><div class="line">                                Img[i] = (<a class="code" href="_s_p_c3___s_d_k_8h.html#accc14a7c843716dfed734f3a03e8d2b6">UInt16</a>) floor(data[i]+0.5);</div><div class="line">                        <span class="keywordflow">else</span></div><div class="line">                                Img[i] = 65535; <span class="comment">// Avoid overflow</span></div><div class="line">                <a class="code" href="group___set.html#ga0b457a043f8243a81edf50c4e0f0369c">SPC3_Set_Background_Img</a>(spc3, Img);</div><div class="line">                <a class="code" href="group___set.html#gae26acc230984264c39e5bb65c8054288">SPC3_Set_Background_Subtraction</a>(spc3, Enabled);</div><div class="line">                <a class="code" href="group___set.html#ga8d9d19541dea48c14122e67ebbccdbcc">SPC3_Apply_settings</a>(spc3);</div><div class="line">                <span class="comment">//now acquire the image with shutter open</span></div><div class="line">                printf(<span class="stringliteral">&quot;\n\n\nOpen the camera shutter and press ENTER...\n&quot;</span>);           </div><div class="line">                getchar();</div><div class="line">                <a class="code" href="group___get.html#ga451637b30c4cf1e118f8f2f5e2917829">SPC3_Prepare_Snap</a>(spc3);</div><div class="line">                <a class="code" href="group___get.html#gafd925e789cb0d273548778e848699e69">SPC3_Get_Snap</a>(spc3);</div><div class="line">        <a class="code" href="group___add_m.html#ga5dde5f5c97f5d3bcf04b95575fe66d1f">SPC3_Save_Img_Disk</a>(spc3, 1, 100, <span class="stringliteral">&quot;Im_DeadTimeReference&quot;</span>, <a class="code" href="group___enum.html#gga668f80b66f368a1f46233e43ab78e124ace8fa6e3d592c00db516c31f16a7b821">TIFF_NO_COMPRESSION</a>);</div><div class="line">                printf(<span class="stringliteral">&quot;The the dead-time corrected image was acquired and stored on the hard disk succesfully!\n&quot;</span>);</div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;3&#39;</span>:<span class="comment">//Test background subtraction</span></div><div class="line">                <span class="comment">//SPC3 constructor and parameter setting</span></div><div class="line">                out=(int)<a class="code" href="group___con_des.html#gaabc8772c1952c0b526959a665bee7016">SPC3_Constr</a>(&amp;spc3, <a class="code" href="group___enum.html#ggac6e73fe6ce68e10b0acd6d2312bdbb35a5ecbcf0afce98b042f35ec71ba03fa4b">Normal</a>,<span class="stringliteral">&quot;&quot;</span>);</div><div class="line">                <a class="code" href="group___set.html#ga8623c09e223ea3246ab50618e59ea208">SPC3_Set_Camera_Par</a>(spc3, 4096, 1000,100,1,Disabled,Disabled,Disabled);</div><div class="line">                <a class="code" href="group___set.html#ga8d9d19541dea48c14122e67ebbccdbcc">SPC3_Apply_settings</a>(spc3);</div><div class="line">                <span class="comment">//acquire background image</span></div><div class="line">                printf(<span class="stringliteral">&quot;\n\n\nClose the camera shutter and press ENTER...\n&quot;</span>);</div><div class="line">                getchar();</div><div class="line">                <a class="code" href="group___get.html#ga451637b30c4cf1e118f8f2f5e2917829">SPC3_Prepare_Snap</a>(spc3);</div><div class="line">                <a class="code" href="group___get.html#gafd925e789cb0d273548778e848699e69">SPC3_Get_Snap</a>(spc3);</div><div class="line">        <a class="code" href="group___add_m.html#ga5dde5f5c97f5d3bcf04b95575fe66d1f">SPC3_Save_Img_Disk</a>(spc3, 1, 1, <span class="stringliteral">&quot;Bg&quot;</span>, <a class="code" href="group___enum.html#gga668f80b66f368a1f46233e43ab78e124ace8fa6e3d592c00db516c31f16a7b821">TIFF_NO_COMPRESSION</a>);</div><div class="line">                <a class="code" href="group___add_m.html#ga2f8901c7892f12dd497a45b62f4e642f">SPC3_Average_Img</a>(spc3, data,1);</div><div class="line">                <span class="keywordflow">for</span>(i=0;i&lt;2048;i++)</div><div class="line">                        <span class="keywordflow">if</span>(data[i]&lt;= 65535)</div><div class="line">                                Img[i] = (<a class="code" href="_s_p_c3___s_d_k_8h.html#accc14a7c843716dfed734f3a03e8d2b6">UInt16</a>) floor(data[i]+0.5);</div><div class="line">                        <span class="keywordflow">else</span></div><div class="line">                                Img[i] = 65535; <span class="comment">// Avoid overflow</span></div><div class="line">                <a class="code" href="group___set.html#ga0b457a043f8243a81edf50c4e0f0369c">SPC3_Set_Background_Img</a>(spc3, Img);</div><div class="line">                <span class="comment">//acquire image with background subtration off</span></div><div class="line">                printf(<span class="stringliteral">&quot;Open the camera shutter and press ENTER ...\n&quot;</span>);</div><div class="line">                getchar();</div><div class="line">                <a class="code" href="group___set.html#gae26acc230984264c39e5bb65c8054288">SPC3_Set_Background_Subtraction</a>(spc3, Disabled);</div><div class="line">                <a class="code" href="group___set.html#ga8d9d19541dea48c14122e67ebbccdbcc">SPC3_Apply_settings</a>(spc3);</div><div class="line">                <a class="code" href="group___get.html#ga451637b30c4cf1e118f8f2f5e2917829">SPC3_Prepare_Snap</a>(spc3);</div><div class="line">                <a class="code" href="group___get.html#gafd925e789cb0d273548778e848699e69">SPC3_Get_Snap</a>(spc3);</div><div class="line">        <a class="code" href="group___add_m.html#ga5dde5f5c97f5d3bcf04b95575fe66d1f">SPC3_Save_Img_Disk</a>(spc3, 1, 1, <span class="stringliteral">&quot;Normal&quot;</span>, <a class="code" href="group___enum.html#gga668f80b66f368a1f46233e43ab78e124ace8fa6e3d592c00db516c31f16a7b821">TIFF_NO_COMPRESSION</a>);</div><div class="line">                <span class="comment">//acquire image with background subtration on</span></div><div class="line">                <a class="code" href="group___set.html#gae26acc230984264c39e5bb65c8054288">SPC3_Set_Background_Subtraction</a>(spc3, Enabled);</div><div class="line">                <a class="code" href="group___get.html#ga451637b30c4cf1e118f8f2f5e2917829">SPC3_Prepare_Snap</a>(spc3);</div><div class="line">                <a class="code" href="group___get.html#gafd925e789cb0d273548778e848699e69">SPC3_Get_Snap</a>(spc3);</div><div class="line">        <a class="code" href="group___add_m.html#ga5dde5f5c97f5d3bcf04b95575fe66d1f">SPC3_Save_Img_Disk</a>(spc3, 1, 1, <span class="stringliteral">&quot;BgSubt&quot;</span>, <a class="code" href="group___enum.html#gga668f80b66f368a1f46233e43ab78e124ace8fa6e3d592c00db516c31f16a7b821">TIFF_NO_COMPRESSION</a>);</div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;4&#39;</span>: <span class="comment">// Test gate</span></div><div class="line">                <span class="comment">//SPC3 constructor and parameter setting</span></div><div class="line">                out=(int)<a class="code" href="group___con_des.html#gaabc8772c1952c0b526959a665bee7016">SPC3_Constr</a>(&amp;spc3, <a class="code" href="group___enum.html#ggac6e73fe6ce68e10b0acd6d2312bdbb35a5a6d9ac0f3d8ebfb251b014eb0cd7bec">Advanced</a>,<span class="stringliteral">&quot;&quot;</span>);</div><div class="line">                <a class="code" href="group___set.html#ga8623c09e223ea3246ab50618e59ea208">SPC3_Set_Camera_Par</a>(spc3, 4096, 1000,100,1,Disabled,Disabled,Disabled);</div><div class="line">                <a class="code" href="group___set.html#ga51a1131fcdd790b3d1ed4a5cd253c21c">SPC3_Set_DeadTime</a>(spc3, 100);</div><div class="line">                <a class="code" href="group___set.html#ga8d9d19541dea48c14122e67ebbccdbcc">SPC3_Apply_settings</a>(spc3);</div><div class="line">                <span class="comment">//Normal image</span></div><div class="line">                printf(<span class="stringliteral">&quot;Acquiring the reference image ...\n&quot;</span>);</div><div class="line">                <a class="code" href="group___get.html#ga451637b30c4cf1e118f8f2f5e2917829">SPC3_Prepare_Snap</a>(spc3);</div><div class="line">                <a class="code" href="group___get.html#gafd925e789cb0d273548778e848699e69">SPC3_Get_Snap</a>(spc3);</div><div class="line">                printf(<span class="stringliteral">&quot;Save the reference image ...\n&quot;</span>);</div><div class="line">        <a class="code" href="group___add_m.html#ga5dde5f5c97f5d3bcf04b95575fe66d1f">SPC3_Save_Img_Disk</a>(spc3, 1, 1000, <span class="stringliteral">&quot;GateNormal&quot;</span>, <a class="code" href="group___enum.html#gga668f80b66f368a1f46233e43ab78e124ace8fa6e3d592c00db516c31f16a7b821">TIFF_NO_COMPRESSION</a>);</div><div class="line">                <span class="comment">//gated image</span></div><div class="line">                <a name="a24"></a><a class="code" href="group___set.html#ga915a4cd744e226acee0288d02a8390e0">SPC3_Set_Gate_Mode</a>(spc3, 1, <a name="a25"></a><a class="code" href="group___enum.html#gga72379015e04e7913b42264153319af1ca6d3bf824c75ea0d0fdfbd9fd634f1b17">Pulsed</a>);</div><div class="line">                <a name="a26"></a><a class="code" href="group___set.html#gaa2c992953dbdd2c23869dcca8ef25353">SPC3_Set_Gate_Values</a>(spc3, 10, 15); <span class="comment">//Shift -10% of 20 ns --&gt; 120 ns, Length 15% of 20 ns --&gt; 3ns</span></div><div class="line">                <a class="code" href="group___set.html#ga8d9d19541dea48c14122e67ebbccdbcc">SPC3_Apply_settings</a>(spc3);</div><div class="line">                printf(<span class="stringliteral">&quot;Acquiring the gated image ...\n&quot;</span>);</div><div class="line">                <a class="code" href="group___get.html#ga451637b30c4cf1e118f8f2f5e2917829">SPC3_Prepare_Snap</a>(spc3);</div><div class="line">                <a class="code" href="group___get.html#gafd925e789cb0d273548778e848699e69">SPC3_Get_Snap</a>(spc3);</div><div class="line">                printf(<span class="stringliteral">&quot;Save the gated image ...\n&quot;</span>);</div><div class="line">        <a class="code" href="group___add_m.html#ga5dde5f5c97f5d3bcf04b95575fe66d1f">SPC3_Save_Img_Disk</a>(spc3, 1, 1000, <span class="stringliteral">&quot;GatePulsed&quot;</span>,<a class="code" href="group___enum.html#gga668f80b66f368a1f46233e43ab78e124ace8fa6e3d592c00db516c31f16a7b821">TIFF_NO_COMPRESSION</a>);</div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;5&#39;</span>: <span class="comment">// Test synchronization output</span></div><div class="line">                <span class="comment">//SPC3 constructor and parameter setting</span></div><div class="line">                out=(int)<a class="code" href="group___con_des.html#gaabc8772c1952c0b526959a665bee7016">SPC3_Constr</a>(&amp;spc3, <a class="code" href="group___enum.html#ggac6e73fe6ce68e10b0acd6d2312bdbb35a5a6d9ac0f3d8ebfb251b014eb0cd7bec">Advanced</a>,<span class="stringliteral">&quot;&quot;</span>);</div><div class="line">                <a class="code" href="group___set.html#ga8623c09e223ea3246ab50618e59ea208">SPC3_Set_Camera_Par</a>(spc3, 8192, 0xFFFF,5,1,Disabled,Disabled,Disabled);</div><div class="line">                <a class="code" href="group___set.html#ga51a1131fcdd790b3d1ed4a5cd253c21c">SPC3_Set_DeadTime</a>(spc3, 100);</div><div class="line">                <span class="comment">//no output</span></div><div class="line">                <a class="code" href="group___set.html#ga95cd1cca080ad3e9f2e227566c12b9ee">SPC3_Set_Trigger_Out_State</a>(spc3,<a name="a27"></a><a class="code" href="group___enum.html#ggaa534ed76b07c3983382a53e00e53e94aac9d3e887722f2bc482bcca9d41c512af">None</a>);</div><div class="line">                <a class="code" href="group___set.html#ga8d9d19541dea48c14122e67ebbccdbcc">SPC3_Apply_settings</a>(spc3);</div><div class="line">                <a class="code" href="group___set.html#ga506b0720df7701ce7eb9241c0db8d760">SPC3_Set_Live_Mode_ON</a>(spc3);</div><div class="line">                printf(<span class="stringliteral">&quot;\n\nNo output ...\n&quot;</span>);</div><div class="line">                printf(<span class="stringliteral">&quot;Press ENTER to continue\n&quot;</span>);            </div><div class="line">                getchar();</div><div class="line">                <a class="code" href="group___set.html#ga199cf23a5624b22baa7ba194ff57c560">SPC3_Set_Live_Mode_OFF</a>(spc3);</div><div class="line">                <span class="comment">//gate clock output</span></div><div class="line">                <a class="code" href="group___set.html#ga95cd1cca080ad3e9f2e227566c12b9ee">SPC3_Set_Trigger_Out_State</a>(spc3,<a name="a28"></a><a class="code" href="group___enum.html#ggaa534ed76b07c3983382a53e00e53e94aaa344ba32f243a2e40c7ae1fde7127cad">Gate_Clk</a>);              </div><div class="line">                <a class="code" href="group___set.html#ga8623c09e223ea3246ab50618e59ea208">SPC3_Set_Camera_Par</a>(spc3, 8192, 0xFFFF,5,1,Disabled,Disabled,Disabled);</div><div class="line">                <a class="code" href="group___set.html#ga8d9d19541dea48c14122e67ebbccdbcc">SPC3_Apply_settings</a>(spc3);</div><div class="line">                <a class="code" href="group___set.html#ga506b0720df7701ce7eb9241c0db8d760">SPC3_Set_Live_Mode_ON</a>(spc3);</div><div class="line">                printf(<span class="stringliteral">&quot;\n\nGate synchronization signal ...\n&quot;</span>);</div><div class="line">                printf(<span class="stringliteral">&quot;Press ENTER to continue\n&quot;</span>);</div><div class="line">                getchar();</div><div class="line">                <a class="code" href="group___set.html#ga199cf23a5624b22baa7ba194ff57c560">SPC3_Set_Live_Mode_OFF</a>(spc3);</div><div class="line">                <span class="comment">//frame sync output</span></div><div class="line">                <a class="code" href="group___set.html#ga95cd1cca080ad3e9f2e227566c12b9ee">SPC3_Set_Trigger_Out_State</a>(spc3,<a class="code" href="group___enum.html#ggaa534ed76b07c3983382a53e00e53e94aa20e5ef7f93ae45b4c343ef8805f9d558">Frame</a>);</div><div class="line">                <a class="code" href="group___set.html#ga8623c09e223ea3246ab50618e59ea208">SPC3_Set_Camera_Par</a>(spc3, 8192, 0xFFFF,5,1,Disabled,Disabled,Disabled);</div><div class="line">                <a class="code" href="group___set.html#ga8d9d19541dea48c14122e67ebbccdbcc">SPC3_Apply_settings</a>(spc3);</div><div class="line">                <a class="code" href="group___set.html#ga506b0720df7701ce7eb9241c0db8d760">SPC3_Set_Live_Mode_ON</a>(spc3);</div><div class="line">                printf(<span class="stringliteral">&quot;\n\nFrame synchronization signal ...\n&quot;</span>);</div><div class="line">                printf(<span class="stringliteral">&quot;Press ENTER to continue\n&quot;</span>);</div><div class="line">                getchar();</div><div class="line">                <a class="code" href="group___set.html#ga199cf23a5624b22baa7ba194ff57c560">SPC3_Set_Live_Mode_OFF</a>(spc3);</div><div class="line">                printf(<span class="stringliteral">&quot;\n\nWait for the trigger input ...\n&quot;</span>);</div><div class="line">                <span class="comment">//trigger in enabled</span></div><div class="line">                <a name="a29"></a><a class="code" href="group___set.html#gaacb59e52038f2cda484a62a995b5a9bd">SPC3_Set_Sync_In_State</a>(spc3, Enabled, 0);</div><div class="line">                <a class="code" href="group___set.html#ga8623c09e223ea3246ab50618e59ea208">SPC3_Set_Camera_Par</a>(spc3, 4096, 10,2,1,Disabled,Disabled,Disabled);</div><div class="line">                <a class="code" href="group___set.html#ga8d9d19541dea48c14122e67ebbccdbcc">SPC3_Apply_settings</a>(spc3);</div><div class="line">                <a class="code" href="group___get.html#ga451637b30c4cf1e118f8f2f5e2917829">SPC3_Prepare_Snap</a>(spc3);</div><div class="line">                <span class="keywordflow">while</span> (trig!=1)</div><div class="line">                        <a name="a30"></a><a class="code" href="group___get.html#gaec8b99e7114d1022fa13db1e9291fe5a">SPC3_IsTriggered</a>(spc3, &amp;trig);</div><div class="line">                printf(<span class="stringliteral">&quot;Trigger signal received!\n&quot;</span>);</div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;6&#39;</span>: <span class="comment">// Test background statistics</span></div><div class="line">                <span class="comment">//The output file &quot;BgHist.txt&quot; contains the number of pixels which had a total number of counts given by the column index for each row. </span></div><div class="line">                <span class="comment">//For example, column 3 contains the /number of pixels which had 3 dark-counts. </span></div><div class="line">                <span class="comment">//Several rows are present because the histogram is calculated for several dead-time values.</span></div><div class="line">                <span class="comment">//SPC3 constructor and parameter setting</span></div><div class="line">                out=(int)<a class="code" href="group___con_des.html#gaabc8772c1952c0b526959a665bee7016">SPC3_Constr</a>(&amp;spc3, <a class="code" href="group___enum.html#ggac6e73fe6ce68e10b0acd6d2312bdbb35a5a6d9ac0f3d8ebfb251b014eb0cd7bec">Advanced</a>,<span class="stringliteral">&quot;&quot;</span>);</div><div class="line">                <a class="code" href="group___set.html#ga8623c09e223ea3246ab50618e59ea208">SPC3_Set_Camera_Par</a>(spc3, 1040, 100,10000,1,Disabled,Disabled,Disabled);</div><div class="line">                f=fopen(<span class="stringliteral">&quot;BgHist.txt&quot;</span>,<span class="stringliteral">&quot;w&quot;</span>);              </div><div class="line">                printf(<span class="stringliteral">&quot;Close the camera shutter and press ENTER ...\n&quot;</span>);</div><div class="line">                getchar();</div><div class="line">                printf(<span class="stringliteral">&quot;Acquiring: &quot;</span>);</div><div class="line">                <span class="keywordflow">for</span>(i=150;i&gt;=50;i-=50) <span class="comment">//different hold-off values</span></div><div class="line">                {               </div><div class="line">                        printf(<span class="stringliteral">&quot;%d ns &quot;</span>,i);</div><div class="line">                        <a class="code" href="group___set.html#ga51a1131fcdd790b3d1ed4a5cd253c21c">SPC3_Set_DeadTime</a>(spc3, i);</div><div class="line">                        <a class="code" href="group___set.html#ga8d9d19541dea48c14122e67ebbccdbcc">SPC3_Apply_settings</a>(spc3);</div><div class="line">                        <a class="code" href="group___get.html#ga451637b30c4cf1e118f8f2f5e2917829">SPC3_Prepare_Snap</a>(spc3);</div><div class="line">                        <a class="code" href="group___get.html#gafd925e789cb0d273548778e848699e69">SPC3_Get_Snap</a>(spc3);</div><div class="line">                        <a class="code" href="group___add_m.html#ga2f8901c7892f12dd497a45b62f4e642f">SPC3_Average_Img</a>(spc3, data,1);</div><div class="line">                        <span class="keywordflow">for</span>(k=0;k&lt;2048;k++)</div><div class="line">                        <span class="keywordflow">if</span>(data[k]&lt;= 65535)</div><div class="line">                                Img[k] = (<a class="code" href="_s_p_c3___s_d_k_8h.html#accc14a7c843716dfed734f3a03e8d2b6">UInt16</a>) floor(data[k]+0.5);</div><div class="line">                        <span class="keywordflow">else</span></div><div class="line">                                Img[k] = 65535; <span class="comment">// Avoid overflow</span></div><div class="line">                        Hist(Img,hist);</div><div class="line">                        <span class="keywordflow">for</span>(j=0;j&lt;65535;j++)</div><div class="line">                                fprintf(f,<span class="stringliteral">&quot;%hd &quot;</span>,hist[j]);</div><div class="line">                        fprintf(f,<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line">                        </div><div class="line">                        </div><div class="line">                }</div><div class="line">                printf(<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line">                fclose(f);</div><div class="line">                <a class="code" href="group___add_m.html#ga5dde5f5c97f5d3bcf04b95575fe66d1f">SPC3_Save_Img_Disk</a>(spc3,1,100,<span class="stringliteral">&quot;DCR_50ns_movie&quot;</span>,<a name="a31"></a><a class="code" href="group___enum.html#gga668f80b66f368a1f46233e43ab78e124a5b7fec2455627277859ac3dd7f0e58d7">SPC3_FILEFORMAT</a>);</div><div class="line">                <a name="a32"></a><a class="code" href="group___add_m.html#ga8b10ddf76257f30ce4dfde4067894038">SPC3_Save_Averaged_Img_Disk</a>(spc3,1,<span class="stringliteral">&quot;DCR_50ns_averaged&quot;</span>,<a class="code" href="group___enum.html#gga668f80b66f368a1f46233e43ab78e124a5b7fec2455627277859ac3dd7f0e58d7">SPC3_FILEFORMAT</a>);</div><div class="line"></div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;7&#39;</span>: <span class="comment">// Calibrate gate</span></div><div class="line">                <span class="comment">//SPC3 constructor and parameter setting</span></div><div class="line">                out=(int)<a class="code" href="group___con_des.html#gaabc8772c1952c0b526959a665bee7016">SPC3_Constr</a>(&amp;spc3, <a class="code" href="group___enum.html#ggac6e73fe6ce68e10b0acd6d2312bdbb35a5a6d9ac0f3d8ebfb251b014eb0cd7bec">Advanced</a>,<span class="stringliteral">&quot;&quot;</span>);</div><div class="line">                <a class="code" href="group___set.html#ga8623c09e223ea3246ab50618e59ea208">SPC3_Set_Camera_Par</a>(spc3, 1040 * 3, 10000, 5, 3, Disabled, Disabled, Disabled);</div><div class="line">                <a class="code" href="group___set.html#ga51a1131fcdd790b3d1ed4a5cd253c21c">SPC3_Set_DeadTime</a>(spc3, 100);</div><div class="line">                <a class="code" href="group___set.html#ga8d9d19541dea48c14122e67ebbccdbcc">SPC3_Apply_settings</a>(spc3);</div><div class="line">                printf(<span class="stringliteral">&quot;Which counter do you want to acquire?\n&quot;</span>);</div><div class="line">                scanf(<span class="stringliteral">&quot;%d&quot;</span>, &amp;counter);</div><div class="line">                <span class="keywordflow">if</span> ((counter &lt; 1) || (counter &gt; 3))</div><div class="line">                {</div><div class="line">                        printf(<span class="stringliteral">&quot;Insert a value between 1 and 3!\n&quot;</span>);</div><div class="line">                        <span class="keywordflow">break</span>;</div><div class="line">                }</div><div class="line">                printf(<span class="stringliteral">&quot;Expose the SPC3 camera to a time-independent luminous signal\n(room light might oscillate at 50 or 60 Hz)\nPress ENTER to continue ...\n&quot;</span>);</div><div class="line">                getchar();</div><div class="line">                getchar();</div><div class="line">                <span class="keywordflow">if</span>((f = fopen(<span class="stringliteral">&quot;GateValues.txt&quot;</span>,<span class="stringliteral">&quot;w&quot;</span>)) == NULL)</div><div class="line">                {</div><div class="line">                        printf(<span class="stringliteral">&quot;Unable to open the output file.\n&quot;</span>);</div><div class="line">                        <span class="keywordflow">break</span>;</div><div class="line">                }</div><div class="line">                <span class="comment">//photon counts without any gate</span></div><div class="line">                <a class="code" href="group___set.html#ga915a4cd744e226acee0288d02a8390e0">SPC3_Set_Gate_Mode</a>(spc3, 1, <a name="a33"></a><a class="code" href="group___enum.html#gga72379015e04e7913b42264153319af1ca6cb140948cbeedb9f7182dd4027e5e37">Continuous</a>);</div><div class="line">                <a class="code" href="group___get.html#ga451637b30c4cf1e118f8f2f5e2917829">SPC3_Prepare_Snap</a>(spc3);</div><div class="line">                <a class="code" href="group___get.html#gafd925e789cb0d273548778e848699e69">SPC3_Get_Snap</a>(spc3);            </div><div class="line">                <a class="code" href="group___add_m.html#ga2f8901c7892f12dd497a45b62f4e642f">SPC3_Average_Img</a>(spc3, data,1);                 </div><div class="line">                gateoff = mean_double(data,2048);                                               </div><div class="line">                printf(<span class="stringliteral">&quot;Gate OFF counts: %.2f\n&quot;</span>,gateoff);</div><div class="line">                fprintf(f,<span class="stringliteral">&quot;Gate OFF counts: %.2f\n&quot;</span>,gateoff);</div><div class="line">                <a class="code" href="group___set.html#ga915a4cd744e226acee0288d02a8390e0">SPC3_Set_Gate_Mode</a>(spc3, 1, <a class="code" href="group___enum.html#gga72379015e04e7913b42264153319af1ca6d3bf824c75ea0d0fdfbd9fd634f1b17">Pulsed</a>);</div><div class="line">                <a class="code" href="group___set.html#ga8d9d19541dea48c14122e67ebbccdbcc">SPC3_Apply_settings</a>(spc3);</div><div class="line">                printf(<span class="stringliteral">&quot;Acquiring:\n\nGate\t\tMean\t\tActual Gate\t\t\n&quot;</span>);</div><div class="line">                <span class="comment">//photon counts for gate witdh ranging from 0% to 100%</span></div><div class="line">                <span class="keywordflow">for</span>(i=0;i&lt;=100;i+=1)</div><div class="line">                {               </div><div class="line">                        <a class="code" href="group___set.html#gaa2c992953dbdd2c23869dcca8ef25353">SPC3_Set_Gate_Values</a>(spc3,0, i);</div><div class="line">                        <a class="code" href="group___set.html#ga8d9d19541dea48c14122e67ebbccdbcc">SPC3_Apply_settings</a>(spc3);</div><div class="line">                        <a class="code" href="group___get.html#ga451637b30c4cf1e118f8f2f5e2917829">SPC3_Prepare_Snap</a>(spc3);</div><div class="line">                        <a class="code" href="group___get.html#gafd925e789cb0d273548778e848699e69">SPC3_Get_Snap</a>(spc3);            </div><div class="line">                        <a class="code" href="group___add_m.html#ga2f8901c7892f12dd497a45b62f4e642f">SPC3_Average_Img</a>(spc3, data,1);                 </div><div class="line">                        y[i] = mean_double(data,2048);          </div><div class="line">                        y[i+101] = y[i]/gateoff*100; <span class="comment">//actual gate width calculated from photon counts</span></div><div class="line">                        x[i]=(double) i;                                                </div><div class="line">                        printf(<span class="stringliteral">&quot;%3.0f\t\t%.2f\t\t%.2f\n&quot;</span>,x[i],y[i],y[i+101]);</div><div class="line">                        fprintf(f,<span class="stringliteral">&quot;%.0f %.2f %.2f\n&quot;</span>,x[i],y[i],y[i+101]);</div><div class="line">                }</div><div class="line">                fclose(f);</div><div class="line">                printf(<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;8&#39;</span>: <span class="comment">// Triple gate mode</span></div><div class="line">                <span class="comment">//SPC3 constructor and parameter setting</span></div><div class="line">                fname = (<span class="keywordtype">char</span>*) calloc(256,<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));</div><div class="line">                out=(int)<a class="code" href="group___con_des.html#gaabc8772c1952c0b526959a665bee7016">SPC3_Constr</a>(&amp;spc3, <a class="code" href="group___enum.html#ggac6e73fe6ce68e10b0acd6d2312bdbb35a5a6d9ac0f3d8ebfb251b014eb0cd7bec">Advanced</a>,<span class="stringliteral">&quot;&quot;</span>);</div><div class="line">                <a class="code" href="group___set.html#ga8623c09e223ea3246ab50618e59ea208">SPC3_Set_Camera_Par</a>(spc3, 1040 * 3, 1000, 20, 3, Disabled, Disabled, Disabled);</div><div class="line">                <a class="code" href="group___set.html#ga51a1131fcdd790b3d1ed4a5cd253c21c">SPC3_Set_DeadTime</a>(spc3, 45);    </div><div class="line">                </div><div class="line">                printf(<span class="stringliteral">&quot;Expose the SPC3 camera to a luminuos signal (pulsed or constant)\nPress ENTER to continue ...\n&quot;</span>);</div><div class="line">                getchar();</div><div class="line">                printf(<span class="stringliteral">&quot;Acquiring...\n&quot;</span>);</div><div class="line">                </div><div class="line">                sprintf(fname, <span class="stringliteral">&quot;Triple gate mode.txt&quot;</span>);</div><div class="line">                <span class="keywordflow">if</span> ((f = fopen(fname, <span class="stringliteral">&quot;w&quot;</span>)) == NULL)</div><div class="line">                {</div><div class="line">                        printf(<span class="stringliteral">&quot;Unable to open the file %s.\n&quot;</span>, fname);</div><div class="line">                        <span class="keywordflow">break</span>;</div><div class="line">                }</div><div class="line"></div><div class="line">                <a name="a34"></a><a class="code" href="group___set.html#gaf14bcdc1e6914ef13ab7b0eae41969a5">SPC3_Set_TripleGate</a>(spc3, Disabled, -400, 10, 10, 10, 0, 100, NULL);</div><div class="line">                <a class="code" href="group___set.html#ga95cd1cca080ad3e9f2e227566c12b9ee">SPC3_Set_Trigger_Out_State</a>(spc3, <a class="code" href="group___enum.html#ggaa534ed76b07c3983382a53e00e53e94aaa344ba32f243a2e40c7ae1fde7127cad">Gate_Clk</a>);</div><div class="line">                <a class="code" href="group___set.html#ga8d9d19541dea48c14122e67ebbccdbcc">SPC3_Apply_settings</a>(spc3);</div><div class="line">                <a class="code" href="group___get.html#ga451637b30c4cf1e118f8f2f5e2917829">SPC3_Prepare_Snap</a>(spc3);</div><div class="line">                <a class="code" href="group___get.html#gafd925e789cb0d273548778e848699e69">SPC3_Get_Snap</a>(spc3);</div><div class="line">                <span class="keywordflow">for</span> (counter = 1; counter &lt;= 3; counter++)</div><div class="line">                {</div><div class="line">                        <a class="code" href="group___add_m.html#ga2f8901c7892f12dd497a45b62f4e642f">SPC3_Average_Img</a>(spc3, data, counter);</div><div class="line">                        gateoff_array[counter - 1] = mean_double(data, 2048);</div><div class="line">                        </div><div class="line">                        printf(<span class="stringliteral">&quot;\nGate OFF counts on counter %d: %.2f\n&quot;</span>, counter, gateoff_array[counter - 1]);</div><div class="line">                        fprintf(f, <span class="stringliteral">&quot;Gate OFF counts on counter %d: %.2f\n&quot;</span>, counter, gateoff_array[counter - 1]);</div><div class="line">                        </div><div class="line">                }</div><div class="line"></div><div class="line">                <span class="keywordflow">for</span> (j = -400; j &lt; 400; j++)</div><div class="line">                {</div><div class="line">                        error = <a class="code" href="group___set.html#gaf14bcdc1e6914ef13ab7b0eae41969a5">SPC3_Set_TripleGate</a>(spc3, Enabled, j, 10, 10, 10, 0, 100, NULL);</div><div class="line">                        <span class="keywordflow">if</span> (error &lt; 0) <span class="keywordflow">break</span>;</div><div class="line">                        <a class="code" href="group___set.html#ga8d9d19541dea48c14122e67ebbccdbcc">SPC3_Apply_settings</a>(spc3);</div><div class="line">                        <a class="code" href="group___get.html#ga451637b30c4cf1e118f8f2f5e2917829">SPC3_Prepare_Snap</a>(spc3);</div><div class="line">                        <a class="code" href="group___get.html#gafd925e789cb0d273548778e848699e69">SPC3_Get_Snap</a>(spc3);</div><div class="line">                        <span class="keywordflow">for</span> (counter = 1; counter &lt;= 3; counter++)</div><div class="line">                        {</div><div class="line">                                <a class="code" href="group___add_m.html#ga2f8901c7892f12dd497a45b62f4e642f">SPC3_Average_Img</a>(spc3, data, counter);</div><div class="line">                                counts[counter - 1] = mean_double(data, 2048);</div><div class="line">                        }</div><div class="line"></div><div class="line">                        printf(<span class="stringliteral">&quot;%d\t\t%.4f\t\t%.4f\t\t%.4f\n&quot;</span>, j, counts[0] / gateoff_array[0] * 100, counts[2] / gateoff_array[2] * 100, counts[1] / gateoff_array[1] * 100);</div><div class="line">                        fprintf(f, <span class="stringliteral">&quot;%d\t\t%.4f\t\t%.4f\t\t%.4f\n&quot;</span>, j, counts[0] / gateoff_array[0] * 100, counts[2] / gateoff_array[2] * 100, counts[1] / gateoff_array[1] * 100);</div><div class="line">                }</div><div class="line">                fclose(f);</div><div class="line"></div><div class="line"></div><div class="line">                printf(<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line">                free(fname);</div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;9&#39;</span>: <span class="comment">// Save and Read images</span></div><div class="line">                <span class="comment">//SPC3 constructor and parameter setting</span></div><div class="line">                out=(int)<a class="code" href="group___con_des.html#gaabc8772c1952c0b526959a665bee7016">SPC3_Constr</a>(&amp;spc3, <a class="code" href="group___enum.html#ggac6e73fe6ce68e10b0acd6d2312bdbb35a5a6d9ac0f3d8ebfb251b014eb0cd7bec">Advanced</a>,<span class="stringliteral">&quot;&quot;</span>);</div><div class="line">                <a class="code" href="group___set.html#ga8623c09e223ea3246ab50618e59ea208">SPC3_Set_Camera_Par</a>(spc3, 1040, 20,2,1,Disabled,Disabled,Disabled);</div><div class="line">                <a class="code" href="group___set.html#ga51a1131fcdd790b3d1ed4a5cd253c21c">SPC3_Set_DeadTime</a>(spc3, 100);</div><div class="line">                <a class="code" href="group___set.html#ga8d9d19541dea48c14122e67ebbccdbcc">SPC3_Apply_settings</a>(spc3);</div><div class="line">                <span class="comment">//acquiring and saving images</span></div><div class="line">                printf(<span class="stringliteral">&quot;Acquiring 20 images and save them on the hard drive in the spc3 file format.\n&quot;</span>);</div><div class="line">                <a class="code" href="group___get.html#ga451637b30c4cf1e118f8f2f5e2917829">SPC3_Prepare_Snap</a>(spc3);</div><div class="line">                <a class="code" href="group___get.html#gafd925e789cb0d273548778e848699e69">SPC3_Get_Snap</a>(spc3);</div><div class="line">                <a class="code" href="group___add_m.html#ga5dde5f5c97f5d3bcf04b95575fe66d1f">SPC3_Save_Img_Disk</a>(spc3, 1,20,<span class="stringliteral">&quot;Test20_Im&quot;</span>, <a class="code" href="group___enum.html#gga668f80b66f368a1f46233e43ab78e124a5b7fec2455627277859ac3dd7f0e58d7">SPC3_FILEFORMAT</a>);</div><div class="line">                <span class="comment">//reading images from file</span></div><div class="line">                printf(<span class="stringliteral">&quot;Read the images from the disk and print the value of the top-left-corner pixel for each frame.\n(Press ENTER to continue)\n&quot;</span>);</div><div class="line">                getchar();</div><div class="line">                <a name="a35"></a><a class="code" href="group___add_m.html#gad03565e87c41f49329ad7f6d04a16126">SPC3_ReadSPC3FileFormatImage</a>(<span class="stringliteral">&quot;Test20_Im.spc3&quot;</span>, 1,1,Img, header );</div><div class="line">                printf(<span class="stringliteral">&quot;Rows: %d, Columns: %d\n&quot;</span>,header[100], header[101]);</div><div class="line">                <span class="keywordflow">for</span>(i=1;i&lt;=20;i++)</div><div class="line">                {</div><div class="line">                        <a class="code" href="group___add_m.html#gad03565e87c41f49329ad7f6d04a16126">SPC3_ReadSPC3FileFormatImage</a>(<span class="stringliteral">&quot;Test20_Im.spc3&quot;</span>, i,1,Img, header );</div><div class="line">                        printf(<span class="stringliteral">&quot;Image %d, pixel value = %hu\n&quot;</span>,i, Img[0]);</div><div class="line">                }</div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;a&#39;</span>: <span class="comment">//Correlation image</span></div><div class="line">                <span class="comment">//SPC3 constructor and parameter setting</span></div><div class="line">                out=(int)<a class="code" href="group___con_des.html#gaabc8772c1952c0b526959a665bee7016">SPC3_Constr</a>(&amp;spc3, <a class="code" href="group___enum.html#ggac6e73fe6ce68e10b0acd6d2312bdbb35a5ecbcf0afce98b042f35ec71ba03fa4b">Normal</a>,<span class="stringliteral">&quot;&quot;</span>);</div><div class="line">                <a class="code" href="group___set.html#ga8623c09e223ea3246ab50618e59ea208">SPC3_Set_Camera_Par</a>(spc3, 10500, 1024*64, 1,1,Disabled,Disabled,Disabled);</div><div class="line">                <a class="code" href="group___set.html#ga51a1131fcdd790b3d1ed4a5cd253c21c">SPC3_Set_DeadTime</a>(spc3, 100);</div><div class="line">                <a class="code" href="group___set.html#ga8d9d19541dea48c14122e67ebbccdbcc">SPC3_Apply_settings</a>(spc3);</div><div class="line">                <span class="comment">//acquire images</span></div><div class="line">                printf(<span class="stringliteral">&quot;Acquiring the images...\n&quot;</span>);</div><div class="line">                <a class="code" href="group___get.html#ga451637b30c4cf1e118f8f2f5e2917829">SPC3_Prepare_Snap</a>(spc3);</div><div class="line">                <a class="code" href="group___get.html#gafd925e789cb0d273548778e848699e69">SPC3_Get_Snap</a>(spc3);</div><div class="line">                <span class="comment">//computer correlation</span></div><div class="line">                <a name="a36"></a><a class="code" href="group___add_m.html#ga079b0fdfb84bc52ddd479c2dce4325cf">SPC3_Set_Correlation_Mode</a>(spc3, <a name="a37"></a><a class="code" href="group___enum.html#gga626d2c9e6d80498715c9b4cb0d1e1a7dae4c141814dec58d37581fadafa78d9a3">MultiTau</a>, 8, Enabled);          </div><div class="line">                printf(<span class="stringliteral">&quot;Starting the multi-tau autocorrelation algorithm\n&quot;</span>);           </div><div class="line">                start = clock();</div><div class="line">                <a name="a38"></a><a class="code" href="group___add_m.html#gac60e135e1d94436f8a11dfcca1e41e75">SPC3_Correlation_Img</a>(spc3,1);</div><div class="line">                stop = clock();</div><div class="line">                printf(<span class="stringliteral">&quot;The correlation has terminated in %.3f s\n&quot;</span>, (stop-start)/(<span class="keywordtype">float</span>)CLOCKS_PER_SEC);               </div><div class="line">                <a name="a39"></a><a class="code" href="group___add_m.html#ga03d0b8be23a3a0bc026851d080fc0954">SPC3_Save_Correlation_Img</a>(spc3,<span class="stringliteral">&quot;Correlation_MultiTau.spcc&quot;</span>);</div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;b&#39;</span>: <span class="comment">//Continuous acquisition, number of integration frames selection. </span></div><div class="line">                <span class="comment">//SPC3 constructor and parameter setting</span></div><div class="line">                out=(int)<a class="code" href="group___con_des.html#gaabc8772c1952c0b526959a665bee7016">SPC3_Constr</a>(&amp;spc3, <a class="code" href="group___enum.html#ggac6e73fe6ce68e10b0acd6d2312bdbb35a5ecbcf0afce98b042f35ec71ba03fa4b">Normal</a>,<span class="stringliteral">&quot;&quot;</span>);</div><div class="line">                printf(<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line">                printf(<span class="stringliteral">&quot;Input the number of frames of 10.40us to be integrated (suggested &gt; 10 to avoid data loss):\n&quot;</span>);</div><div class="line">                scanf(<span class="stringliteral">&quot;%d&quot;</span>,&amp;integFrames);</div><div class="line">                printf(<span class="stringliteral">&quot;Total integration time: %.2fus\n&quot;</span>, (<span class="keywordtype">float</span>)(10.40*integFrames));</div><div class="line">                <a class="code" href="group___set.html#ga8623c09e223ea3246ab50618e59ea208">SPC3_Set_Camera_Par</a>(spc3, 1050, 1, integFrames,1,Disabled,Disabled,Disabled);</div><div class="line">                <a class="code" href="group___set.html#ga51a1131fcdd790b3d1ed4a5cd253c21c">SPC3_Set_DeadTime</a>(spc3, 100);</div><div class="line">                <a class="code" href="group___set.html#ga8d9d19541dea48c14122e67ebbccdbcc">SPC3_Apply_settings</a>(spc3);</div><div class="line">                <span class="comment">//acquire images</span></div><div class="line">                printf(<span class="stringliteral">&quot;Continuous acquisition will be started and 10 memory dumps performed.\n&quot;</span>);</div><div class="line">                printf(<span class="stringliteral">&quot;Press ENTER to start continuous acquisition...\n&quot;</span>);</div><div class="line">                getchar();</div><div class="line">                getchar();</div><div class="line">                <a name="a40"></a><a class="code" href="group___get.html#ga9e417b59fff41eb642267a14a744aa96">SPC3_Start_ContAcq</a>(spc3, <span class="stringliteral">&quot;contacq.spc3&quot;</span>);</div><div class="line">                <span class="keywordflow">for</span>(i=1; i&lt;10; i++)</div><div class="line">                {       </div><div class="line">                        <span class="keywordflow">if</span> (<a name="a41"></a><a class="code" href="group___get.html#ga63519805b02b0e16b98143c6d3a81032">SPC3_Get_Memory</a>(spc3,&amp;read_bytes)==<a class="code" href="group___enum.html#ggafe63699eafdb0b69d032828ea3f157d3a2bc49ec37d6a5715dd23e85f1ff5bb59">OK</a>)</div><div class="line">                        {       </div><div class="line">                                total_bytes=total_bytes+read_bytes;</div><div class="line">                                printf(<span class="stringliteral">&quot;Acquired %f bytes in %d readout operation\n&quot;</span>,total_bytes, i);</div><div class="line">                                SLEEP(1*MILLIS);</div><div class="line">                        }</div><div class="line">                        <span class="keywordflow">else</span></div><div class="line">                                <span class="keywordflow">break</span>;</div><div class="line">                }       </div><div class="line">                <a name="a42"></a><a class="code" href="group___get.html#ga1d35deea7fcbffb1c55b08b590e83b77">SPC3_Stop_ContAcq</a>(spc3);</div><div class="line">                printf(<span class="stringliteral">&quot;Acquisition saved to contacq.spc3.\n&quot;</span>);</div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;c&#39;</span>: <span class="comment">//Continuous acquisition in memory, number of integration frames selection. </span></div><div class="line">                <span class="comment">//SPC3 constructor and parameter setting</span></div><div class="line">                out = (int)<a class="code" href="group___con_des.html#gaabc8772c1952c0b526959a665bee7016">SPC3_Constr</a>(&amp;spc3, <a class="code" href="group___enum.html#ggac6e73fe6ce68e10b0acd6d2312bdbb35a5ecbcf0afce98b042f35ec71ba03fa4b">Normal</a>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line">                printf(<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line">                printf(<span class="stringliteral">&quot;Input the number of frames of 10.40us to be integrated (suggested &gt; 10 to avoid data loss):\n&quot;</span>);</div><div class="line">                scanf(<span class="stringliteral">&quot;%d&quot;</span>, &amp;integFrames);</div><div class="line">                printf(<span class="stringliteral">&quot;Total integration time: %.2fus\n&quot;</span>, (<span class="keywordtype">float</span>)(10.40*integFrames));</div><div class="line">                <a class="code" href="group___set.html#ga8623c09e223ea3246ab50618e59ea208">SPC3_Set_Camera_Par</a>(spc3, 1050, 1, integFrames, 1, Disabled, Disabled, Disabled);</div><div class="line">                <a class="code" href="group___set.html#ga51a1131fcdd790b3d1ed4a5cd253c21c">SPC3_Set_DeadTime</a>(spc3, 100);</div><div class="line">                <a class="code" href="group___set.html#ga8d9d19541dea48c14122e67ebbccdbcc">SPC3_Apply_settings</a>(spc3);</div><div class="line">                <span class="comment">//acquire images</span></div><div class="line">                printf(<span class="stringliteral">&quot;Continuous acquisition will be started and 10 memory dumps performed.\n&quot;</span>);</div><div class="line">                printf(<span class="stringliteral">&quot;Press ENTER to start continuous acquisition...\n&quot;</span>);</div><div class="line">                getchar();</div><div class="line">                getchar();</div><div class="line">                <a name="a43"></a><a class="code" href="group___get.html#gaa73b6973de1a90c44a1e2e67dd709987">SPC3_Start_ContAcq_in_Memory</a>(spc3);</div><div class="line">                <span class="keywordflow">for</span> (i = 1; i&lt;11; i++)</div><div class="line">                {</div><div class="line">                        <span class="keywordflow">if</span> (<a name="a44"></a><a class="code" href="group___get.html#gaf9421339323443d09483e58a66bea3f4">SPC3_Get_Memory_Buffer</a>(spc3, &amp;read_bytes, &amp;buffer) == <a class="code" href="group___enum.html#ggafe63699eafdb0b69d032828ea3f157d3a2bc49ec37d6a5715dd23e85f1ff5bb59">OK</a>)</div><div class="line">                        {</div><div class="line">                                total_bytes = total_bytes + read_bytes;</div><div class="line">                                printf(<span class="stringliteral">&quot;Acquired %f bytes in %d readout operation\n&quot;</span>, total_bytes, i);</div><div class="line">                                SLEEP(1 * MILLIS);</div><div class="line">                        }</div><div class="line">                        <span class="keywordflow">else</span></div><div class="line">                                <span class="keywordflow">break</span>;</div><div class="line">                }</div><div class="line">                <a name="a45"></a><a class="code" href="group___get.html#ga90e713e488d060616149fa8cbaf7799a">SPC3_Stop_ContAcq_in_Memory</a>(spc3);</div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">        <span class="keywordflow">default</span>:</div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line"></div><div class="line"><span class="comment">// Destructors                                    //</span></div><div class="line"><span class="comment"></span></div><div class="line">        <span class="keywordflow">if</span>(spc3)</div><div class="line">                <a name="a46"></a><a class="code" href="group___con_des.html#ga7158d5c16e5100c34c72b8bd23e48b1f">SPC3_Destr</a>(spc3);</div><div class="line">        spc3 = NULL;</div><div class="line">        free(Img);</div><div class="line">        free(Imgd);</div><div class="line">        free(data);</div><div class="line">        free(y);</div><div class="line">        free(x);</div><div class="line">        free(z);</div><div class="line">        printf(<span class="stringliteral">&quot;Press ENTER to continue\n&quot;</span>);</div><div class="line">        getchar();</div><div class="line">        <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Oct 19 2018 10:32:43 for Single Photon Counting Camera SDK by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
